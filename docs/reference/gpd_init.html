<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Initial estimates for Generalized Pareto parameters — gpd_init • rust</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Initial estimates for Generalized Pareto parameters — gpd_init" />
<meta property="og:description" content="Calculates initial estimates and estimated standard errors (SEs) for the
generalized Pareto parameters sigma and xi based on an
assumed random sample from this distribution.  Also, calculates
initial estimates and estimated standard errors for
phi1 = sigma and phi2 = xi + sigma / xm." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.7.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/rust-a-vignette.html">Introducing rust: Ratio-of-Uniforms Simulation with Transformation</a>
    </li>
    <li>
      <a href="../articles/rust-b-when-to-use-vignette.html">When can rust be used?</a>
    </li>
    <li>
      <a href="../articles/rust-c-using-rcpp-vignette.html">Rusting Faster: Simulation using Rcpp</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paulnorthrop/rust">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Initial estimates for Generalized Pareto parameters</h1>
    <small class="dont-index">Source: <a href='https://github.com/paulnorthrop/rust/blob/master/R/gp_example.R'><code>R/gp_example.R</code></a></small>
    <div class="hidden name"><code>gpd_init.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates initial estimates and estimated standard errors (SEs) for the
generalized Pareto parameters sigma and xi based on an
assumed random sample from this distribution.  Also, calculates
initial estimates and estimated standard errors for
phi1 = sigma and phi2 = xi + sigma / xm.</p>
    </div>

    <pre class="usage"><span class='fu'>gpd_init</span>(<span class='no'>gpd_data</span>, <span class='no'>m</span>, <span class='no'>xm</span>, <span class='kw'>sum_gp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>xi_eq_zero</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>init_ests</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gpd_data</th>
      <td><p>A numeric vector containing positive sample values.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>A numeric scalar.  The sample size, i.e. the length of gpd_data.</p></td>
    </tr>
    <tr>
      <th>xm</th>
      <td><p>A numeric scalar. The sample maximum.</p></td>
    </tr>
    <tr>
      <th>sum_gp</th>
      <td><p>A numeric scalar. The sum of the sample values.</p></td>
    </tr>
    <tr>
      <th>xi_eq_zero</th>
      <td><p>A logical scalar.  If TRUE assume that the shape
parameter xi = 0.</p></td>
    </tr>
    <tr>
      <th>init_ests</th>
      <td><p>A numeric vector.  Initial estimate of
theta = (sigma, xi).  If supplied <code>gpd_init()</code> just
returns the corresponding initial estimate of phi = (phi1, phi2).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>init_ests</code> is not supplied by the user, a list is returned
  with components</p>
<dt>init</dt><dd><p>A numeric vector. Initial estimates of sigma
     and xi.</p></dd>
    <dt>se</dt><dd><p>A numeric vector. Estimated standard errors of
     sigma and xi.</p></dd>
    <dt>init_phi</dt><dd><p>A numeric vector. Initial estimates of
     phi1 = sigma and phi2 = xi + sigma / xm,
     where xm is the maximum of <code>gpd_data</code>.</p></dd>
    <dt>se_phi</dt><dd><p>A numeric vector. Estimated standard errors of
     phi1 and phi2.</p></dd>
  If init_ests is supplied then only the numeric vector
  init_phi is returned.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The main aim is to calculate an admissible estimate of theta,
  i.e. one at which the log-likelihood is finite (necessary for the
  posterior log-density to be finite) at the estimate, and associated
  estimated SEs. These are converted into estimates and SEs for phi.  The
  latter can be used to set values of <code>min_phi</code> and <code>max_phi</code>
  for input to <code>find_lambda</code>.</p>
<p>In the default setting (<code>xi_eq_zero = FALSE</code> and
  <code>init_ests = NULL</code>) the methods tried are Maximum Likelihood
  Estimation (MLE) (Grimshaw, 1993), Probability-Weighted Moments (PWM)
  (Hosking and Wallis, 1987) and Linear Combinations of Ratios of Spacings
  (LRS) (Reiss and Thomas, 2007, page 134) in that order.</p>
<p>For xi &lt; -1 the likelihood is unbounded, MLE may fail when xi is not
  greater than -0.5 and the observed Fisher information for (sigma, xi) has
  finite variance only if xi &gt; -0.25.  We use the ML estimate provided that
  the estimate of xi returned from <code>gpd_mle</code> is greater than -1. We only
  use the SE if the MLE of xi is greater than -0.25.</p>
<p>If either the MLE or the SE are not OK then we try PWM.  We use the PWM
  estimate only if is admissible, and the MLE was not OK.  We use the PWM SE,
  but this will be <code><a href='https://rdrr.io/r/base/c.html'>c(NA, NA)</a></code> is the PWM estimate of xi is &gt; 1/2.  If
  the estimate is still not OK then we try LRS.  As a last resort, which
  will tend to occur only when xi is strongly negative, we set xi = -1 and
  estimate sigma conditional on this.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Grimshaw, S. D. (1993) Computing Maximum Likelihood Estimates
  for the Generalized Pareto Distribution.  Technometrics, 35(2), 185-191.
  and Computing (1991) 1, 129-133. <a href='http://dx.doi.org/10.1007/BF01889987'>http://dx.doi.org/10.1007/BF01889987</a>.</p>
<p>Hosking, J. R. M. and Wallis, J. R. (1987) Parameter and Quantile
  Estimation for the Generalized Pareto Distribution. Technometrics, 29(3),
  339-349. <a href='http://dx.doi.org/10.2307/1269343'>http://dx.doi.org/10.2307/1269343</a>.</p>
<p>Reiss, R.-D., Thomas, M. (2007) Statistical Analysis of Extreme Values
  with Applications to Insurance, Finance, Hydrology and Other Fields.Birkhauser.
  <a href='http://dx.doi.org/10.1007/978-3-7643-7399-3'>http://dx.doi.org/10.1007/978-3-7643-7399-3</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gpd_sum_stats.html'>gpd_sum_stats</a></code> to calculate summary statistics for
  use in <code>gpd_loglik</code>.</p>
<p><code><a href='rgpd.html'>rgpd</a></code> for simulation from a generalized Pareto</p>
<p><code><a href='find_lambda.html'>find_lambda</a></code> to produce (somewhat) automatically
  a list for the argument <code>lambda</code> of <code>ru</code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'># Sample data from a GP(sigma, xi) distribution</span>
<span class='no'>gpd_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rgpd.html'>rgpd</a></span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>xi</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='co'># Calculate summary statistics for use in the log-likelihood</span>
<span class='no'>ss</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gpd_sum_stats.html'>gpd_sum_stats</a></span>(<span class='no'>gpd_data</span>)
<span class='co'># Calculate initial estimates</span>
<span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span>(<span class='no'>gpd_init</span>, <span class='no'>ss</span>)</div><div class='output co'>#&gt; $init
#&gt; [1]  1.0470484 -0.1435586
#&gt; 
#&gt; $se
#&gt; [1] 0.13350077 0.08039187
#&gt; 
#&gt; $init_phi
#&gt; [1] 1.04704836 0.09212756
#&gt; 
#&gt; $se_phi
#&gt; [1] 0.13350077 0.06115491
#&gt; </div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


