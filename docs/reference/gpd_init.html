<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Initial estimates for Generalized Pareto parameters — gpd_init • rust</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Initial estimates for Generalized Pareto parameters — gpd_init"><meta property="og:description" content="Calculates initial estimates and estimated standard errors (SEs) for the
generalized Pareto parameters \(\sigma\) and \(\xi\) based on an
assumed random sample from this distribution.  Also, calculates
initial estimates and estimated standard errors for
\(\phi\)1 = \(\sigma\)
and
\(\phi\)2 = \(\xi + \sigma x\)
(m), where
\(x\)(m) is the sample
maximum threshold exceedance."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/rust-a-vignette.html">Introducing rust: Ratio-of-Uniforms Simulation with Transformation</a>
    </li>
    <li>
      <a href="../articles/rust-b-when-to-use-vignette.html">When can rust be used?</a>
    </li>
    <li>
      <a href="../articles/rust-c-using-rcpp-vignette.html">Rusting Faster: Simulation using Rcpp</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/rust/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Initial estimates for Generalized Pareto parameters</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/rust/blob/HEAD/R/gp_example.R" class="external-link"><code>R/gp_example.R</code></a></small>
    <div class="hidden name"><code>gpd_init.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates initial estimates and estimated standard errors (SEs) for the
generalized Pareto parameters \(\sigma\) and \(\xi\) based on an
assumed random sample from this distribution.  Also, calculates
initial estimates and estimated standard errors for
\(\phi\)<sub>1</sub> = \(\sigma\)
and
\(\phi\)<sub>2</sub> = \(\xi + \sigma x\)
<sub>(m)</sub>, where
\(x\)<sub>(m)</sub> is the sample
maximum threshold exceedance.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gpd_init</span><span class="op">(</span><span class="va">gpd_data</span>, <span class="va">m</span>, <span class="va">xm</span>, sum_gp <span class="op">=</span> <span class="cn">NULL</span>, xi_eq_zero <span class="op">=</span> <span class="cn">FALSE</span>, init_ests <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>gpd_data</dt>
<dd><p>A numeric vector containing positive sample values.</p></dd>


<dt>m</dt>
<dd><p>A numeric scalar.  The sample size, i.e., the length of
<code>gpd_data</code>.</p></dd>


<dt>xm</dt>
<dd><p>A numeric scalar. The sample maximum.</p></dd>


<dt>sum_gp</dt>
<dd><p>A numeric scalar. The sum of the sample values.</p></dd>


<dt>xi_eq_zero</dt>
<dd><p>A logical scalar.  If TRUE assume that the shape
parameter \(\xi = 0\).</p></dd>


<dt>init_ests</dt>
<dd><p>A numeric vector.  Initial estimate of
\(\theta = (\sigma, \xi)\).  If supplied <code>gpd_init()</code>
returns the corresponding initial estimate of
\(\phi\) = (\(\phi\)<sub>1</sub>,
\(\phi\)<sub>2</sub>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>init_ests</code> is not supplied by the user, a list is returned
  with components</p>
<dl><dt>init</dt>
<dd><p>A numeric vector. Initial estimates of \(\sigma\)
     and \(\xi\).</p></dd>

    <dt>se</dt>
<dd><p>A numeric vector. Estimated standard errors of
     \(\sigma\) and \(\xi\).</p></dd>

    <dt>init_phi</dt>
<dd><p>A numeric vector. Initial estimates of
     \(\phi\)<sub>1</sub> = \(\sigma\)
     and
    \(\phi\)<sub>2</sub> = \(\xi + \sigma x\)
    <sub>(m)</sub>
    where \(x\)<sub>(m)</sub>
    is the maximum of <code>gpd_data</code>.</p></dd>

    <dt>se_phi</dt>
<dd><p>A numeric vector. Estimated standard errors of
     \(\phi\)<sub>1</sub>
     and
     \(\phi\)<sub>1</sub>.</p></dd>

</dl><p>If <code>init_ests</code> is supplied then only the numeric vector</p>
<p></p>
<p><code>init_phi</code> is returned.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The main aim is to calculate an admissible estimate of
  \(\theta\), i.e., one at which the log-likelihood is finite (necessary
  for the posterior log-density to be finite) at the estimate, and
  associated estimated SEs. These are converted into estimates and SEs for
  \(\phi\).  The latter can be used to set values of <code>min_phi</code> and
  <code>max_phi</code> for input to <code>find_lambda</code>.</p>
<p>In the default setting (<code>xi_eq_zero = FALSE</code> and
  <code>init_ests = NULL</code>) the methods tried are Maximum Likelihood
  Estimation (MLE) (Grimshaw, 1993), Probability-Weighted Moments (PWM)
  (Hosking and Wallis, 1987) and Linear Combinations of Ratios of Spacings
  (LRS) (Reiss and Thomas, 2007, page 134) in that order.</p>
<p>For \(\xi &lt; -1\) the likelihood is unbounded, MLE may fail when
  \(\xi\) is not greater than \(-0.5\) and the observed Fisher
  information for \((sigma, xi)\) has finite variance only if
  \(\xi &gt; -0.25\).  We use the ML estimate provided that
  the estimate of \(\xi\) returned from <code>gpd_mle</code> is greater than
  \(-1\). We only use the SE if the MLE of \(\xi\) is greater than
  \(-0.25\).</p>
<p>If either the MLE or the SE are not OK then we try PWM.  We use the PWM
  estimate only if is admissible, and the MLE was not OK.  We use the PWM SE,
  but this will be <code>c(NA, NA)</code> is the PWM estimate of \(\xi\) is
  \(&gt; 1/2\).  If the estimate is still not OK then we try LRS.  As a last
  resort, which will tend to occur only when \(\xi\) is strongly negative,
  we set \(\xi = -1\) and estimate sigma conditional on this.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Grimshaw, S. D. (1993) Computing Maximum Likelihood Estimates
  for the Generalized Pareto Distribution.  Technometrics, 35(2), 185-191.
  and Computing (1991) 1, 129-133. <a href="https://doi.org/10.1007/BF01889987" class="external-link">doi:10.1007/BF01889987</a>
.</p>
<p>Hosking, J. R. M. and Wallis, J. R. (1987) Parameter and Quantile
  Estimation for the Generalized Pareto Distribution. Technometrics, 29(3),
  339-349. <a href="https://doi.org/10.2307/1269343" class="external-link">doi:10.2307/1269343</a>
.</p>
<p>Reiss, R.-D., Thomas, M. (2007) Statistical Analysis of Extreme Values
  with Applications to Insurance, Finance, Hydrology and Other Fields.Birkhauser.
  <a href="https://doi.org/10.1007/978-3-7643-7399-3" class="external-link">doi:10.1007/978-3-7643-7399-3</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gpd_sum_stats.html">gpd_sum_stats</a></code> to calculate summary statistics for
  use in <code>gpd_loglik</code>.</p>
<p><code><a href="rgpd.html">rgpd</a></code> for simulation from a generalized Pareto</p>
<p><code><a href="find_lambda.html">find_lambda</a></code> to produce (somewhat) automatically
  a list for the argument <code>lambda</code> of <code>ru</code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Sample data from a GP(sigma, xi) distribution</span></span></span>
<span class="r-in"><span><span class="va">gpd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgpd.html">rgpd</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">100</span>, xi <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculate summary statistics for use in the log-likelihood</span></span></span>
<span class="r-in"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="gpd_sum_stats.html">gpd_sum_stats</a></span><span class="op">(</span><span class="va">gpd_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculate initial estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">gpd_init</span>, <span class="va">ss</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $init</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.91049523 0.04750441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigma[u]        xi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1326040 0.1059878 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $init_phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9104952 0.1897499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se_phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.13260399 0.09278117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

