<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Initial estimates for Generalized Pareto parameters — gpd_init • rust</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Initial estimates for Generalized Pareto parameters — gpd_init"><meta name="description" content="Calculates initial estimates and estimated standard errors (SEs) for the
generalized Pareto parameters \(\sigma\) and \(\xi\) based on an
assumed random sample from this distribution.  Also, calculates
initial estimates and estimated standard errors for
\(\phi\)1 = \(\sigma\)
and
\(\phi\)2 = \(\xi + \sigma x\)
(m), where
\(x\)(m) is the sample
maximum threshold exceedance."><meta property="og:description" content="Calculates initial estimates and estimated standard errors (SEs) for the
generalized Pareto parameters \(\sigma\) and \(\xi\) based on an
assumed random sample from this distribution.  Also, calculates
initial estimates and estimated standard errors for
\(\phi\)1 = \(\sigma\)
and
\(\phi\)2 = \(\xi + \sigma x\)
(m), where
\(x\)(m) is the sample
maximum threshold exceedance."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rust</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rust-a-vignette.html">Introducing rust: Ratio-of-Uniforms Simulation with Transformation</a></li>
    <li><a class="dropdown-item" href="../articles/rust-b-when-to-use-vignette.html">When can rust be used?</a></li>
    <li><a class="dropdown-item" href="../articles/rust-c-using-rcpp-vignette.html">Rusting Faster: Simulation using Rcpp</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/rust/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Initial estimates for Generalized Pareto parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/rust/blob/HEAD/R/gp_example.R"><code>R/gp_example.R</code></a></small>
      <div class="d-none name"><code>gpd_init.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates initial estimates and estimated standard errors (SEs) for the
generalized Pareto parameters \(\sigma\) and \(\xi\) based on an
assumed random sample from this distribution.  Also, calculates
initial estimates and estimated standard errors for
\(\phi\)<sub>1</sub> = \(\sigma\)
and
\(\phi\)<sub>2</sub> = \(\xi + \sigma x\)
<sub>(m)</sub>, where
\(x\)<sub>(m)</sub> is the sample
maximum threshold exceedance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gpd_init</span><span class="op">(</span><span class="va">gpd_data</span>, <span class="va">m</span>, <span class="va">xm</span>, sum_gp <span class="op">=</span> <span class="cn">NULL</span>, xi_eq_zero <span class="op">=</span> <span class="cn">FALSE</span>, init_ests <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-gpd-data">gpd_data<a class="anchor" aria-label="anchor" href="#arg-gpd-data"></a></dt>
<dd><p>A numeric vector containing positive sample values.</p></dd>


<dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>A numeric scalar.  The sample size, i.e., the length of
<code>gpd_data</code>.</p></dd>


<dt id="arg-xm">xm<a class="anchor" aria-label="anchor" href="#arg-xm"></a></dt>
<dd><p>A numeric scalar. The sample maximum.</p></dd>


<dt id="arg-sum-gp">sum_gp<a class="anchor" aria-label="anchor" href="#arg-sum-gp"></a></dt>
<dd><p>A numeric scalar. The sum of the sample values.</p></dd>


<dt id="arg-xi-eq-zero">xi_eq_zero<a class="anchor" aria-label="anchor" href="#arg-xi-eq-zero"></a></dt>
<dd><p>A logical scalar.  If TRUE assume that the shape
parameter \(\xi = 0\).</p></dd>


<dt id="arg-init-ests">init_ests<a class="anchor" aria-label="anchor" href="#arg-init-ests"></a></dt>
<dd><p>A numeric vector.  Initial estimate of
\(\theta = (\sigma, \xi)\).  If supplied <code>gpd_init()</code>
returns the corresponding initial estimate of
\(\phi\) = (\(\phi\)<sub>1</sub>,
\(\phi\)<sub>2</sub>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>init_ests</code> is not supplied by the user, a list is returned
  with components</p>
<dl><dt>init</dt>
<dd><p>A numeric vector. Initial estimates of \(\sigma\)
     and \(\xi\).</p></dd>

    <dt>se</dt>
<dd><p>A numeric vector. Estimated standard errors of
     \(\sigma\) and \(\xi\).</p></dd>

    <dt>init_phi</dt>
<dd><p>A numeric vector. Initial estimates of
     \(\phi\)<sub>1</sub> = \(\sigma\)
     and
    \(\phi\)<sub>2</sub> = \(\xi + \sigma x\)
    <sub>(m)</sub>
    where \(x\)<sub>(m)</sub>
    is the maximum of <code>gpd_data</code>.</p></dd>

    <dt>se_phi</dt>
<dd><p>A numeric vector. Estimated standard errors of
     \(\phi\)<sub>1</sub>
     and
     \(\phi\)<sub>1</sub>.</p></dd>

</dl><p>If <code>init_ests</code> is supplied then only the numeric vector
  <code>init_phi</code> is returned.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The main aim is to calculate an admissible estimate of
  \(\theta\), i.e., one at which the log-likelihood is finite (necessary
  for the posterior log-density to be finite) at the estimate, and
  associated estimated SEs. These are converted into estimates and SEs for
  \(\phi\).  The latter can be used to set values of <code>min_phi</code> and
  <code>max_phi</code> for input to <code>find_lambda</code>.</p>
<p>In the default setting (<code>xi_eq_zero = FALSE</code> and
  <code>init_ests = NULL</code>) the methods tried are Maximum Likelihood
  Estimation (MLE) (Grimshaw, 1993), Probability-Weighted Moments (PWM)
  (Hosking and Wallis, 1987) and Linear Combinations of Ratios of Spacings
  (LRS) (Reiss and Thomas, 2007, page 134) in that order.</p>
<p>For \(\xi &lt; -1\) the likelihood is unbounded, MLE may fail when
  \(\xi\) is not greater than \(-0.5\) and the observed Fisher
  information for \((\sigma, \xi)\) has finite variance only if
  \(\xi &gt; -0.25\).  We use the ML estimate provided that
  the estimate of \(\xi\) returned from <code>gpd_mle</code> is greater than
  \(-1\). We only use the SE if the MLE of \(\xi\) is greater than
  \(-0.25\).</p>
<p>If either the MLE or the SE are not OK then we try PWM.  We use the PWM
  estimate only if is admissible, and the MLE was not OK.  We use the PWM SE,
  but this will be <code>c(NA, NA)</code> if the PWM estimate of \(\xi\) is
  \(&gt; 1/2\).  If the estimate is still not OK then we try LRS.  As a last
  resort, which will tend to occur only when \(\xi\) is strongly negative,
  we set \(\xi = -1\) and estimate sigma conditional on this.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Grimshaw, S. D. (1993) Computing Maximum Likelihood Estimates
  for the Generalized Pareto Distribution.  Technometrics, 35(2), 185-191.
  and Computing (1991) 1, 129-133. <a href="https://doi.org/10.1007/BF01889987" class="external-link">doi:10.1007/BF01889987</a>
.</p>
<p>Hosking, J. R. M. and Wallis, J. R. (1987) Parameter and Quantile
  Estimation for the Generalized Pareto Distribution. Technometrics, 29(3),
  339-349. <a href="https://doi.org/10.2307/1269343" class="external-link">doi:10.2307/1269343</a>
.</p>
<p>Reiss, R.-D., Thomas, M. (2007) Statistical Analysis of Extreme Values
  with Applications to Insurance, Finance, Hydrology and Other Fields.Birkhauser.
  <a href="https://doi.org/10.1007/978-3-7643-7399-3" class="external-link">doi:10.1007/978-3-7643-7399-3</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gpd_sum_stats.html">gpd_sum_stats</a></code> to calculate summary statistics for
  use in <code>gpd_loglik</code>.</p>
<p><code><a href="rgpd.html">rgpd</a></code> for simulation from a generalized Pareto</p>
<p><code><a href="find_lambda.html">find_lambda</a></code> to produce (somewhat) automatically
  a list for the argument <code>lambda</code> of <code>ru</code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Sample data from a GP(sigma, xi) distribution</span></span></span>
<span class="r-in"><span><span class="va">gpd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgpd.html">rgpd</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">100</span>, xi <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculate summary statistics for use in the log-likelihood</span></span></span>
<span class="r-in"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="gpd_sum_stats.html">gpd_sum_stats</a></span><span class="op">(</span><span class="va">gpd_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculate initial estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">gpd_init</span>, <span class="va">ss</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $init</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.93388659 0.01770686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigma[u]        xi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1457051 0.1197723 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $init_phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9338866 0.2191765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se_phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.14570507 0.09811086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

